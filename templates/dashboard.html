{% extends "base.html" %}
{% load app_tags %}
{% load static %}

{% block title %}{% page_title "首页" %}{% endblock %}

{% block content %}
<div class="content-header">
    <div class="container-fluid">
        <div class="row mb-2">
            <div class="col-sm-6">
                <h1 class="m-0">首页</h1>
            </div>
            <div class="col-sm-6">
                <ol class="breadcrumb float-sm-right">
                    <li class="breadcrumb-item active">首页</li>
                </ol>
            </div>
        </div>
    </div>
</div>

<div class="content">
    <div class="container-fluid">

        {% if current_enterprise %}
        <!-- 企业信息卡片 -->
        <div class="card mb-4">
            <div class="card-header">
                <div class="row">
                    <div class="col-md-8">
                        <h3 class="card-title">企业信息</h3>
                    </div>
                    {% if request.user.is_enterprise_admin %}
                    <div class="col-md-4 text-right">
                        <a href="{% url 'enterprises:enterprise_update' current_enterprise.pk %}" class="btn btn-primary btn-sm">
                            <i class="fas fa-edit mr-1"></i> 编辑企业信息
                        </a>
                    </div>
                    {% endif %}
                </div>
            </div>
            <div class="card-body">
                <div class="row">
                    <div class="col-md-2">
                        <div class="text-center">
                            {% if current_enterprise.logo %}
                            <img src="{{ current_enterprise.logo.url }}" alt="{{ current_enterprise.name }} Logo" 
                                 class="img-circle elevation-2 mb-2" style="width: 80px; height: 80px; object-fit: cover;">
                            {% else %}
                            <img src="{% static 'img/enterprise-default.svg' %}" alt="默认企业Logo" 
                                 class="img-circle elevation-2 mb-2" style="width: 80px; height: 80px; object-fit: cover;">
                            {% endif %}
                        </div>
                    </div>
                    <div class="col-md-10">
                        <div class="row">
                            <div class="col-md-6">
                                <dl class="row mb-0">
                                    <dt class="col-sm-4">企业名称:</dt>
                                    <dd class="col-sm-8 font-weight-bold">{{ current_enterprise.name }}</dd>
                                    
                                    <dt class="col-sm-4">统一社会信用代码:</dt>
                                    <dd class="col-sm-8">{{ current_enterprise.unified_social_credit_code }}</dd>
                                    
                                    <dt class="col-sm-4">企业类型:</dt>
                                    <dd class="col-sm-8">{{ current_enterprise.get_enterprise_type_display }}</dd>
                                    
                                    <dt class="col-sm-4">法定代表人:</dt>
                                    <dd class="col-sm-8">{{ current_enterprise.legal_representative|default:'-' }}</dd>
                                </dl>
                            </div>
                            <div class="col-md-6">
                                <dl class="row mb-0">
                                    <dt class="col-sm-4">注册资本:</dt>
                                    <dd class="col-sm-8">
                                        {% if current_enterprise.registered_capital %}
                                        {{ current_enterprise.registered_capital }} 万元
                                        {% else %}
                                        -
                                        {% endif %}
                                    </dd>
                                    
                                    <dt class="col-sm-4">成立日期:</dt>
                                    <dd class="col-sm-8">{{ current_enterprise.establishment_date|date:"Y-m-d"|default:'-' }}</dd>
                                    
                                    <dt class="col-sm-4">联系电话:</dt>
                                    <dd class="col-sm-8">{{ current_enterprise.contact_phone|default:'-' }}</dd>
                                    
                                    <dt class="col-sm-4">联系邮箱:</dt>
                                    <dd class="col-sm-8">{{ current_enterprise.contact_email|default:'-' }}</dd>
                                </dl>
                            </div>
                        </div>
                        
                        {% if current_enterprise.business_scope %}
                        <div class="mt-3">
                            <dt class="mb-1">经营范围:</dt>
                            <dd class="text-sm text-gray-600">
                                {{ current_enterprise.business_scope|truncatechars:200 }}
                                {% if current_enterprise.business_scope|length > 200 %}
                                <a href="{% url 'enterprises:enterprise_detail' current_enterprise.pk %}" class="text-primary">查看全部</a>
                                {% endif %}
                            </dd>
                        </div>
                        {% endif %}
                    </div>
                </div>
            </div>
        </div>
        {% else %}
        <div class="alert alert-warning">
            请先选择或创建企业
        </div>
        {% endif %}

        <div class="row">
            <div class="col-md-4">
                <div class="card">
                    <div class="card-body">
                        <h5 class="card-title">企业管理</h5>
                        <p class="card-text">管理企业信息和订阅</p>
                        <a href="{% url 'enterprises:enterprise_list' %}" class="btn btn-primary">进入</a>
                    </div>
                </div>
            </div>

            <div class="col-md-4">
                <div class="card">
                    <div class="card-body">
                        <h5 class="card-title">用户管理</h5>
                        <p class="card-text">管理系统用户</p>
                        <a href="{% url 'accounts:user_list' %}" class="btn btn-primary">进入</a>
                    </div>
                </div>
            </div>

            <div class="col-md-4">
                <div class="card">
                    <div class="card-body">
                        <h5 class="card-title">技能认定</h5>
                        <p class="card-text">职业技能等级认定管理</p>
                        <a href="{% url 'skill_assessment:dashboard' %}" class="btn btn-primary">进入</a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}